<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Análise e Operação v2.3</title>
    <style>
        body {
            font-family: "Times New Roman", serif;
            background-color: #07251F;
            color: #EAF9E1;
            margin: 20px;
            padding: 10px;
        }
        .form-container {
            background-color: #103a2f;
            padding: 20px 30px;
            border-radius: 12px;
            border: 1px solid #d4af37;
            width: 100%;
            max-width: 750px;
            margin: 20px auto;
        }
        h2 {
            text-align: center;
            color: #d4af37;
            font-size: 26px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label,
        .fieldset-legend-main,
        .question-title {
            display: block;
            font-weight: bold;
            color: #EAF9E1;
            margin-bottom: 8px;
            font-size: 18px;
        }
        .fieldset-legend-main {
            padding: 0 10px;
            color: #d4af37;
        }
        .form-group input[type="text"],
        .form-group input[type="datetime-local"],
        .form-group input[type="number"],
        .form-group input[type="file"],
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border-radius: 12px;
            box-sizing: border-box;
            font-size: 16px;
            font-family: "Times New Roman", serif;
            background-color: #EAF9E1;
            color: #07251F;
            border: 1px solid #07251F;
        }
        .dynamic-input {
            margin-top: 10px;
        }
        .main-fieldset {
            border: 1px solid #2a5a4a;
            border-radius: 8px;
            padding: 15px 25px;
            margin-bottom: 25px;
        }
        .sub-group {
            margin-bottom: 20px;
            border-bottom: 1px dashed #2a5a4a;
            padding-bottom: 20px;
        }
        .sub-group:last-child {
             border-bottom: none;
             margin-bottom: 0;
             padding-bottom: 0;
        }
        .options-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px 20px;
            align-items: center;
        }
        .option-item {
            display: flex;
            align-items: center;
        }
        .option-item input[type="radio"] {
            margin-right: 10px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }
        .option-item label {
            color: #EAF9E1;
            font-weight: normal;
            cursor: pointer;
            margin-bottom: 0;
            font-size: 16px;
        }
        .submit-button {
            background-color: #d4af37;
            color: #07251F;
            border: none;
            font-weight: bold;
            cursor: pointer;
            display: inline-block;
            margin-top: 20px;
            padding: 12px 25px;
            border-radius: 12px;
            font-size: 18px;
            font-family: "Times New Roman", serif;
        }
        .submit-button:hover {
            opacity: 0.9;
        }
        .form-group input[type="file"] {
            background-color: transparent;
            border: 1px dashed #d4af37;
            color: #EAF9E1;
            padding: 8px;
        }
        .form-group input[type="file"]::file-selector-button {
            margin-right: 15px;
            border: none;
            background: #d4af37;
            padding: 8px 12px;
            border-radius: 5px;
            color: #07251F;
            cursor: pointer;
            transition: background-color .2s ease-in-out;
            font-family: "Times New Roman", serif;
            font-weight: bold;
        }
        .form-group input[type="file"]::file-selector-button:hover {
            opacity: 0.9;
        }
    </style>
</head>
<body>

    <div class="form-container">
        <form id="analiseOperacaoForm" action="https://script.google.com/macros/s/AKfycbzMohuS0VcT2_f5f-gU4h-8-ADFknbYvvdlODFNyKIWhSzgYVTYM8drqOhJZodiSQRB/exec" method="post" enctype="multipart/form-data">
            <h2>Formulário de Análise e Operação v2.3</h2>
            
            <div class="form-group">
                <label for="evento_datetime">Data e Horário do Evento</label>
                <input type="datetime-local" id="evento_datetime" name="evento_datetime" required>
            </div>

            <fieldset class="main-fieldset">
                <legend class="fieldset-legend-main">Validações Metodológicas</legend>
                <div class="sub-group">
                    <p class="question-title">1. Mental</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="mental_1" name="validacao_mental" value="inexistente" required><label for="mental_1">Inexistente</label></div>
                        <div class="option-item"><input type="radio" id="mental_2" name="validacao_mental" value="muito_ruim"><label for="mental_2">Muito Ruim</label></div>
                        <div class="option-item"><input type="radio" id="mental_3" name="validacao_mental" value="ruim"><label for="mental_3">Ruim</label></div>
                        <div class="option-item"><input type="radio" id="mental_4" name="validacao_mental" value="bom"><label for="mental_4">Bom</label></div>
                        <div class="option-item"><input type="radio" id="mental_5" name="validacao_mental" value="muito_bom"><label for="mental_5">Muito Bom</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">2. Análise do histórico pessoal em operações similares</p>
                    <div class="options-container">
                         <div class="option-item"><input type="radio" id="hist_1" name="validacao_historico" value="inexistente" required><label for="hist_1">Inexistente</label></div>
                         <div class="option-item"><input type="radio" id="hist_2" name="validacao_historico" value="muito_ruim"><label for="hist_2">Muito Ruim</label></div>
                         <div class="option-item"><input type="radio" id="hist_3" name="validacao_historico" value="ruim"><label for="hist_3">Ruim</label></div>
                         <div class="option-item"><input type="radio" id="hist_4" name="validacao_historico" value="bom"><label for="hist_4">Bom</label></div>
                         <div class="option-item"><input type="radio" id="hist_5" name="validacao_historico" value="muito_bom"><label for="hist_5">Muito Bom</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">3. Disponibilidade e ambiente de análise</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="amb_1" name="validacao_ambiente" value="inexistente" required><label for="amb_1">Inexistente</label></div>
                        <div class="option-item"><input type="radio" id="amb_2" name="validacao_ambiente" value="muito_ruim"><label for="amb_2">Muito Ruim</label></div>
                        <div class="option-item"><input type="radio" id="amb_3" name="validacao_ambiente" value="ruim"><label for="amb_3">Ruim</label></div>
                        <div class="option-item"><input type="radio" id="amb_4" name="validacao_ambiente" value="bom"><label for="amb_4">Bom</label></div>
                        <div class="option-item"><input type="radio" id="amb_5" name="validacao_ambiente" value="muito_bom"><label for="amb_5">Muito Bom</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">4. Análise do contexto e campeonato</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="contexto_1" name="validacao_contexto_campeonato" value="inexistente" required><label for="contexto_1">Inexistente</label></div>
                        <div class="option-item"><input type="radio" id="contexto_2" name="validacao_contexto_campeonato" value="muito_ruim"><label for="contexto_2">Muito Ruim</label></div>
                        <div class="option-item"><input type="radio" id="contexto_3" name="validacao_contexto_campeonato" value="ruim"><label for="contexto_3">Ruim</label></div>
                        <div class="option-item"><input type="radio"id="contexto_4" name="validacao_contexto_campeonato" value="bom"><label for="contexto_4">Bom</label></div>
                        <div class="option-item"><input type="radio" id="contexto_5" name="validacao_contexto_campeonato" value="muito_bom"><label for="contexto_5">Muito Bom</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">5. Análise do relatório da partida</p>
                    <div class="options-container">
                         <div class="option-item"><input type="radio" id="relatorio_1" name="validacao_relatorio_partida" value="inexistente" required><label for="relatorio_1">Inexistente</label></div>
                         <div class="option-item"><input type="radio" id="relatorio_2" name="validacao_relatorio_partida" value="muito_ruim"><label for="relatorio_2">Muito Ruim</label></div>
                         <div class="option-item"><input type="radio" id="relatorio_3" name="validacao_relatorio_partida" value="ruim"><label for="relatorio_3">Ruim</label></div>
                         <div class="option-item"><input type="radio" id="relatorio_4" name="validacao_relatorio_partida" value="bom"><label for="relatorio_4">Bom</label></div>
                         <div class="option-item"><input type="radio" id="relatorio_5" name="validacao_relatorio_partida" value="muito_bom"><label for="relatorio_5">Muito Bom</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">6. Análise visual de partidas recentes e contexto similar</p>
                    <div class="options-container">
                         <div class="option-item"><input type="radio" id="visual_1" name="validacao_visual_partidas" value="inexistente" required><label for="visual_1">Inexistente</label></div>
                         <div class="option-item"><input type="radio" id="visual_2" name="validacao_visual_partidas" value="muito_ruim"><label for="visual_2">Muito Ruim</label></div>
                         <div class="option-item"><input type="radio" id="visual_3" name="validacao_visual_partidas" value="ruim"><label for="visual_3">Ruim</label></div>
                         <div class="option-item"><input type="radio" id="visual_4" name="validacao_visual_partidas" value="bom"><label for="visual_4">Bom</label></div>
                         <div class="option-item"><input type="radio" id="visual_5" name="validacao_visual_partidas" value="muito_bom"><label for="visual_5">Muito Bom</label></div>
                    </div>
                </div>
                 <div class="sub-group">
                    <p class="question-title">7. Análise de prognósticos e Tips</p>
                    <div class="options-container">
                         <div class="option-item"><input type="radio" id="tips_1" name="validacao_tips_prognosticos" value="inexistente" required><label for="tips_1">Inexistente</label></div>
                         <div class="option-item"><input type="radio" id="tips_2" name="validacao_tips_prognosticos" value="muito_ruim"><label for="tips_2">Muito Ruim</label></div>
                         <div class="option-item"><input type="radio" id="tips_3" name="validacao_tips_prognosticos" value="ruim"><label for="tips_3">Ruim</label></div>
                         <div class="option-item"><input type="radio" id="tips_4" name="validacao_tips_prognosticos" value="bom"><label for="tips_4">Bom</label></div>
                         <div class="option-item"><input type="radio" id="tips_5" name="validacao_tips_prognosticos" value="muito_bom"><label for="tips_5">Muito Bom</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">8. Pré-partida (Condições Meteorológicas, Odds Aumentadas, Escalações, etc.)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="pre_1" name="validacao_prepartida_condicoes" value="inexistente" required><label for="pre_1">Inexistente</label></div>
                        <div class="option-item"><input type="radio" id="pre_2" name="validacao_prepartida_condicoes" value="muito_ruim"><label for="pre_2">Muito Ruim</label></div>
                        <div class="option-item"><input type="radio" id="pre_3" name="validacao_prepartida_condicoes" value="ruim"><label for="pre_3">Ruim</label></div>
                        <div class="option-item"><input type="radio" id="pre_4" name="validacao_prepartida_condicoes" value="bom"><label for="pre_4">Bom</label></div>
                        <div class="option-item"><input type="radio" id="pre_5" name="validacao_prepartida_condicoes" value="muito_bom"><label for="pre_5">Muito Bom</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">9. Pesquisa de Odds</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="odds_1" name="validacao_pesquisa_odds" value="inexistente" required><label for="odds_1">Inexistente</label></div>
                        <div class="option-item"><input type="radio" id="odds_2" name="validacao_pesquisa_odds" value="muito_ruim"><label for="odds_2">Muito Ruim</label></div>
                        <div class="option-item"><input type="radio" id="odds_3" name="validacao_pesquisa_odds" value="ruim"><label for="odds_3">Ruim</label></div>
                        <div class="option-item"><input type="radio" id="odds_4" name="validacao_pesquisa_odds" value="bom"><label for="odds_4">Bom</label></div>
                        <div class="option-item"><input type="radio" id="odds_5" name="validacao_pesquisa_odds" value="muito_bom"><label for="odds_5">Muito Bom</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">10. Realização Operacional (Validação Pré-Operação)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="op_val_1" name="validacao_realizacao_operacional_pre" value="inexistente" required><label for="op_val_1">Inexistente</label></div>
                        <div class="option-item"><input type="radio" id="op_val_2" name="validacao_realizacao_operacional_pre" value="muito_ruim"><label for="op_val_2">Muito Ruim</label></div>
                        <div class="option-item"><input type="radio" id="op_val_3" name="validacao_realizacao_operacional_pre" value="ruim"><label for="op_val_3">Ruim</label></div>
                        <div class="option-item"><input type="radio" id="op_val_4" name="validacao_realizacao_operacional_pre" value="bom"><label for="op_val_4">Bom</label></div>
                        <div class="option-item"><input type="radio" id="op_val_5" name="validacao_realizacao_operacional_pre" value="muito_bom"><label for="op_val_5">Muito Bom</label></div>
                    </div>
                </div>
            </fieldset>

            <div class="form-group">
                <label for="referencia">Referência</label>
                <input type="text" id="referencia" name="referencia" placeholder="Ex: Partida da 5ª rodada, ID da análise, etc." required>
            </div>
            
            <div class="form-group">
                <label for="estrategia_select">Estratégia</label>
                <select id="estrategia_select" name="estrategia_select" required>
                    <option value="" disabled selected>Selecione uma opção</option>
                    <option value="Arbitragem">Arbitragem</option>
                    <option value="IA">IA</option>
                    <option value="Multiplas Brasil">Multiplas Brasil</option>
                    <option value="Multiplas Mundo">Multiplas Mundo</option>
                    <option value="Pessoal">Pessoal</option>
                    <option value="Superodds">Superodds</option>
                    <option value="Tipsters">Tipsters</option>
                    <option value="Valor">Valor</option>
                    <option value="outro_estrategia">Outro...</option>
                </select>
                <input type="text" id="outra_estrategia_input" name="outra_estrategia_input" class="dynamic-input" placeholder="Digite a nova estratégia e pressione Enter" style="display: none;">
            </div>

            <div class="form-group">
                <label for="esporte_select">Esporte</label>
                <select id="esporte_select" name="esporte_select" required>
                     <option value="" disabled selected>Selecione um esporte</option>
                     <option value="Basquete">Basquete</option>
                     <option value="Futebol">Futebol</option>
                     <option value="outro_esporte">Outro...</option>
                </select>
                <input type="text" id="outro_esporte_input" name="outro_esporte_input" class="dynamic-input" placeholder="Digite o novo esporte e pressione Enter" style="display: none;">
            </div>

            <fieldset id="analise_geral_fieldset" class="main-fieldset">
                <legend class="fieldset-legend-main">Analise</legend>
                <div class="sub-group">
                    <p class="question-title">1X2 (2+ Gols Folga Sobre Consenso)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="geral_1x2_na" name="analise_1x2_resultado" value="na" required><label for="geral_1x2_na">Não se Aplica</label></div>
                        <div class="option-item"><input type="radio" id="geral_1x2_1" name="analise_1x2_resultado" value="1"><label for="geral_1x2_1">1</label></div>
                        <div class="option-item"><input type="radio" id="geral_1x2_2" name="analise_1x2_resultado" value="2"><label for="geral_1x2_2">2</label></div>
                        <div class="option-item"><input type="radio" id="geral_1x2_3" name="analise_1x2_resultado" value="3"><label for="geral_1x2_3">3</label></div>
                        <div class="option-item"><input type="radio" id="geral_1x2_4" name="analise_1x2_resultado" value="4"><label for="geral_1x2_4">4</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Gols - Totais (1 Abaixo/Acima Outlier)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="geral_gols_na" name="analise_gols_totais" value="na" required><label for="geral_gols_na">Não se Aplica</label></div>
                        <div class="option-item"><input type="radio" id="geral_gols_sim" name="analise_gols_totais" value="sim"><label for="geral_gols_sim">Sim</label></div>
                        <div class="option-item"><input type="radio" id="geral_gols_nao" name="analise_gols_totais" value="nao"><label for="geral_gols_nao">Não</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Gols - Equipes (1 Abaixo/Acima Outlier)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="geral_gols_eq_na" name="analise_gols_equipes" value="na" required><label for="geral_gols_eq_na">Não se Aplica</label></div>
                        <div class="option-item"><input type="radio" id="geral_gols_eq_sim" name="analise_gols_equipes" value="sim"><label for="geral_gols_eq_sim">Sim</label></div>
                        <div class="option-item"><input type="radio" id="geral_gols_eq_nao" name="analise_gols_equipes" value="nao"><label for="geral_gols_eq_nao">Não</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Gols - Totais - HT (1 Abaixo/Acima Outlier)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="geral_gols_ht_na" name="analise_gols_totais_ht" value="na" required><label for="geral_gols_ht_na">Não se Aplica</label></div>
                        <div class="option-item"><input type="radio" id="geral_gols_ht_sim" name="analise_gols_totais_ht" value="sim"><label for="geral_gols_ht_sim">Sim</label></div>
                        <div class="option-item"><input type="radio" id="geral_gols_ht_nao" name="analise_gols_totais_ht" value="nao"><label for="geral_gols_ht_nao">Não</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Gols - Equipes - HT (1 Abaixo/Acima Outlier)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="geral_gols_eq_ht_na" name="analise_gols_equipes_ht" value="na" required><label for="geral_gols_eq_ht_na">Não se Aplica</label></div>
                        <div class="option-item"><input type="radio" id="geral_gols_eq_ht_sim" name="analise_gols_equipes_ht" value="sim"><label for="geral_gols_eq_ht_sim">Sim</label></div>
                        <div class="option-item"><input type="radio" id="geral_gols_eq_ht_nao" name="analise_gols_equipes_ht" value="nao"><label for="geral_gols_eq_ht_nao">Não</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Cartões, Escanteios, Defesas de Goleiro, Faltas, Finalizações Totais ou no Alvo, Impedimentos etc. (Dentro 65% Média e 1 Acima/Abaixo Outlier)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="geral_mercados_adv_na" name="analise_mercados_diversos" value="na" required><label for="geral_mercados_adv_na">Não se Aplica</label></div>
                        <div class="option-item"><input type="radio" id="geral_mercados_adv_sim" name="analise_mercados_diversos" value="sim"><label for="geral_mercados_adv_sim">Sim</label></div>
                        <div class="option-item"><input type="radio" id="geral_mercados_adv_nao" name="analise_mercados_diversos" value="nao"><label for="geral_mercados_adv_nao">Não</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Handicap (2+ Gols Folga Sobre Consenso)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="geral_handicap_na" name="analise_handicap_europeu" value="na" required><label for="geral_handicap_na">Não se Aplica</label></div>
                        <div class="option-item"><input type="radio" id="geral_handicap_1" name="analise_handicap_europeu" value="1"><label for="geral_handicap_1">1</label></div>
                        <div class="option-item"><input type="radio" id="geral_handicap_2" name="analise_handicap_europeu" value="2"><label for="geral_handicap_2">2</label></div>
                        <div class="option-item"><input type="radio" id="geral_handicap_3" name="analise_handicap_europeu" value="3"><label for="geral_handicap_3">3</label></div>
                        <div class="option-item"><input type="radio" id="geral_handicap_4" name="analise_handicap_europeu" value="4"><label for="geral_handicap_4">4</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Handicap Asiático (2+ Gols Folga Sobre Consenso)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="geral_ha_na" name="analise_handicap_asiatico" value="na" required><label for="geral_ha_na">Não se Aplica</label></div>
                        <div class="option-item"><input type="radio" id="geral_ha_1" name="analise_handicap_asiatico" value="1"><label for="geral_ha_1">1</label></div>
                        <div class="option-item"><input type="radio" id="geral_ha_2" name="analise_handicap_asiatico" value="2"><label for="geral_ha_2">2</label></div>
                        <div class="option-item"><input type="radio" id="geral_ha_3" name="analise_handicap_asiatico" value="3"><label for="geral_ha_3">3</label></div>
                        <div class="option-item"><input type="radio" id="geral_ha_4" name="analise_handicap_asiatico" value="4"><label for="geral_ha_4">4</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Jogadores (1+ Sem Exceção)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="geral_jogadores_na" name="analise_mercados_jogadores" value="na" required><label for="geral_jogadores_na">Não se Aplica</label></div>
                        <div class="option-item"><input type="radio" id="geral_jogadores_sim" name="analise_mercados_jogadores" value="sim"><label for="geral_jogadores_sim">Sim</label></div>
                        <div class="option-item"><input type="radio" id="geral_jogadores_nao" name="analise_mercados_jogadores" value="nao"><label for="geral_jogadores_nao">Não</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Outros (1+ Sem Exceção)</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="geral_outros_na" name="analise_outros_mercados" value="na" required><label for="geral_outros_na">Não se Aplica</label></div>
                        <div class="option-item"><input type="radio" id="geral_outros_sim" name="analise_outros_mercados" value="sim"><label for="geral_outros_sim">Sim</label></div>
                        <div class="option-item"><input type="radio" id="geral_outros_nao" name="analise_outros_mercados" value="nao"><label for="geral_outros_nao">Não</label></div>
                    </div>
                </div>
            </fieldset>

            <div class="form-group">
                <label for="casa_apostas_select">Casa de Apostas (Bet)</label>
                <select id="casa_apostas_select" name="casa_apostas_select" required>
                    <option value="" disabled selected>Selecione a plataforma</option>
                    <option value="Bet365">Bet365</option>
                    <option value="Betano">Betano</option>
                    <option value="Betfair">Betfair</option>
                    <option value="BetMGM">BetMGM</option>
                    <option value="Sportingbet">Sportingbet</option>
                    <option value="Superbet">Superbet</option>
                    <option value="outro_casa_apostas">Outro...</option>
                </select>
                <input type="text" id="outra_casa_apostas_input" name="outra_casa_apostas_input" class="dynamic-input" placeholder="Digite a nova casa e pressione Enter" style="display: none;">
            </div>

            <div class="form-group">
                <label for="campeonato_select">Campeonato</label>
                <select id="campeonato_select" name="campeonato_select" required>
                    <option value="" disabled selected>Selecione ou adicione</option>
                    <option value="outro_campeonato">Adicionar Novo Campeonato...</option>
                </select>
                <input type="text" id="outro_campeonato_input" name="outro_campeonato_input" class="dynamic-input" placeholder="Digite o nome do campeonato e pressione Enter" style="display: none;">
            </div>
            
            <div class="form-group">
                <label for="perfil_partida_select">Perfil da Partida</label>
                <select id="perfil_partida_select" name="perfil_partida_select" required>
                    <option value="" disabled selected>Selecione um perfil</option>
                    <option value="Múltipla">Múltipla</option>
                    <option value="Classificatória">Classificatória</option>
                    <option value="Classificatória - Decisiva">Classificatória - Decisiva</option>
                    <option value="Eliminatória - Partida de Ida">Eliminatória - Partida de Ida</option>
                    <option value="Eliminatória - Partida de Volta">Eliminatória - Partida de Volta</option>
                    <option value="Eliminatória - Partida Única">Eliminatória - Partida Única</option>
                    <option value="Final - Partida de Ida">Final - Partida de Ida</option>
                    <option value="Final - Partida de Volta">Final - Partida de Volta</option>
                    <option value="Final - Partida Única">Final - Partida Única</option>
                    <option value="Pontos Corridos">Pontos Corridos</option>
                    <option value="Pontos Corridos - Decisiva">Pontos Corridos - Decisiva</option>
                    <option value="outro_perfil_partida">Outro...</option>
                </select>
                <input type="text" id="outro_perfil_partida_input" name="outro_perfil_partida_input" class="dynamic-input" placeholder="Digite o novo perfil e pressione Enter" style="display: none;">
            </div>

            <div class="form-group">
                <label for="home_team_reordered_select">Home (Equipe da Casa)</label>
                <select id="home_team_reordered_select" name="home_team_reordered_select" required>
                    <option value="" disabled selected>Selecione ou adicione uma equipe</option>
                    <option value="outro_home_team_reordered">Adicionar Nova Equipe...</option>
                </select>
                <input type="text" id="outro_home_team_reordered_input" name="outro_home_team_reordered_input" class="dynamic-input" placeholder="Digite o nome da equipe e pressione Enter" style="display: none;">
            </div>

            <div class="form-group">
                <label for="away_team_reordered_select">Away (Equipe Visitante)</label>
                <select id="away_team_reordered_select" name="away_team_reordered_select" required>
                    <option value="" disabled selected>Selecione ou adicione uma equipe</option>
                    <option value="outro_away_team_reordered">Adicionar Nova Equipe...</option>
                </select>
                <input type="text" id="outro_away_team_reordered_input" name="outro_away_team_reordered_input" class="dynamic-input" placeholder="Digite o nome da equipe e pressione Enter" style="display: none;">
            </div>

            <div class="form-group">
                <label for="stake_select">Stake</label>
                <select id="stake_select" name="stake_select" required>
                    <option value="" disabled selected>Selecione ou adicione uma stake</option>
                    <option value="0.2 Un">0.2 Un</option>
                    <option value="0.5 Un">0.5 Un</option>
                    <option value="1 Un">1 Un</option>
                    <option value="2 Un">2 Un</option>
                    <option value="2.5 Un">2.5 Un</option>
                    <option value="outro_stake">Outra Stake...</option>
                </select>
                <input type="number" id="outra_stake_input" name="outra_stake_input" class="dynamic-input" placeholder="Digite o valor numérico (ex: 3.5)" step="0.1" style="display: none;">
            </div>

            <fieldset id="mercados_explorados_fieldset" class="main-fieldset">
                <legend class="fieldset-legend-main">Mercados Explorados (Selecione ao menos uma opção em toda esta seção)</legend>
                <div class="sub-group">
                    <p class="question-title">1X2</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="m_1x2_home" name="m_1x2_selecao" value="home"><label for="m_1x2_home">Home</label></div>
                        <div class="option-item"><input type="radio" id="m_1x2_away" name="m_1x2_selecao" value="away"><label for="m_1x2_away">Away</label></div>
                        <div class="option-item"><input type="radio" id="m_1x2_draw" name="m_1x2_selecao" value="draw"><label for="m_1x2_draw">Draw</label></div>
                        <div class="option-item"><input type="radio" id="m_1x2_hd" name="m_1x2_selecao" value="home_draw"><label for="m_1x2_hd">Home&Draw</label></div>
                        <div class="option-item"><input type="radio" id="m_1x2_ad" name="m_1x2_selecao" value="away_draw"><label for="m_1x2_ad">Away&Draw</label></div>
                         <div class="option-item"><input type="radio" id="m_1x2_na" name="m_1x2_selecao" value="na"><label for="m_1x2_na">Não Explorado</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Gols</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="m_gols_totais" name="m_gols_selecao" value="totais"><label for="m_gols_totais">Under/Over - Totais</label></div>
                        <div class="option-item"><input type="radio" id="m_gols_equipes" name="m_gols_selecao" value="equipes"><label for="m_gols_equipes">Under/Over - Equipes</label></div>
                        <div class="option-item"><input type="radio" id="m_gols_totais_ht" name="m_gols_selecao" value="totais_ht"><label for="m_gols_totais_ht">Under/Over - Totais - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_gols_equipes_ht" name="m_gols_selecao" value="equipes_ht"><label for="m_gols_equipes_ht">Under/Over - Equipes - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_gols_na" name="m_gols_selecao" value="na"><label for="m_gols_na">Não Explorado</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Cartões</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="m_cartoes_totais" name="m_cartoes_selecao" value="totais"><label for="m_cartoes_totais">Under/Over - Totais</label></div>
                        <div class="option-item"><input type="radio" id="m_cartoes_equipes" name="m_cartoes_selecao" value="equipes"><label for="m_cartoes_equipes">Under/Over - Equipes</label></div>
                        <div class="option-item"><input type="radio" id="m_cartoes_totais_ht" name="m_cartoes_selecao" value="totais_ht"><label for="m_cartoes_totais_ht">Under/Over - Totais - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_cartoes_equipes_ht" name="m_cartoes_selecao" value="equipes_ht"><label for="m_cartoes_equipes_ht">Under/Over - Equipes - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_cartoes_na" name="m_cartoes_selecao" value="na"><label for="m_cartoes_na">Não Explorado</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Defesas de Goleiro</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="m_defesas_home" name="m_defesas_selecao" value="home"><label for="m_defesas_home">Home</label></div>
                        <div class="option-item"><input type="radio" id="m_defesas_away" name="m_defesas_selecao" value="away"><label for="m_defesas_away">Away</label></div>
                        <div class="option-item"><input type="radio" id="m_defesas_ha" name="m_defesas_selecao" value="home_away"><label for="m_defesas_ha">Home/Away</label></div>
                        <div class="option-item"><input type="radio" id="m_defesas_na" name="m_defesas_selecao" value="na"><label for="m_defesas_na">Não Explorado</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Escanteios</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="m_escanteios_totais" name="m_escanteios_selecao" value="totais"><label for="m_escanteios_totais">Under/Over - Totais</label></div>
                        <div class="option-item"><input type="radio" id="m_escanteios_equipes" name="m_escanteios_selecao" value="equipes"><label for="m_escanteios_equipes">Under/Over - Equipes</label></div>
                        <div class="option-item"><input type="radio" id="m_escanteios_totais_ht" name="m_escanteios_selecao" value="totais_ht"><label for="m_escanteios_totais_ht">Under/Over - Totais - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_escanteios_equipes_ht" name="m_escanteios_selecao" value="equipes_ht"><label for="m_escanteios_equipes_ht">Under/Over - Equipes - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_escanteios_na" name="m_escanteios_selecao" value="na"><label for="m_escanteios_na">Não Explorado</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Finalizações</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="m_finalizacoes_totais" name="m_finalizacoes_selecao" value="totais"><label for="m_finalizacoes_totais">Under/Over - Totais</label></div>
                        <div class="option-item"><input type="radio" id="m_finalizacoes_equipes" name="m_finalizacoes_selecao" value="equipes"><label for="m_finalizacoes_equipes">Under/Over - Equipes</label></div>
                        <div class="option-item"><input type="radio" id="m_finalizacoes_totais_ht" name="m_finalizacoes_selecao" value="totais_ht"><label for="m_finalizacoes_totais_ht">Under/Over - Totais - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_finalizacoes_equipes_ht" name="m_finalizacoes_selecao" value="equipes_ht"><label for="m_finalizacoes_equipes_ht">Under/Over - Equipes - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_finalizacoes_na" name="m_finalizacoes_selecao" value="na"><label for="m_finalizacoes_na">Não Explorado</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Finalizações no Gol</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="m_f_gol_totais" name="m_f_gol_selecao" value="totais"><label for="m_f_gol_totais">Under/Over - Totais</label></div>
                        <div class="option-item"><input type="radio" id="m_f_gol_equipes" name="m_f_gol_selecao" value="equipes"><label for="m_f_gol_equipes">Under/Over - Equipes</label></div>
                        <div class="option-item"><input type="radio" id="m_f_gol_totais_ht" name="m_f_gol_selecao" value="totais_ht"><label for="m_f_gol_totais_ht">Under/Over - Totais - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_f_gol_equipes_ht" name="m_f_gol_selecao" value="equipes_ht"><label for="m_f_gol_equipes_ht">Under/Over - Equipes - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_f_gol_na" name="m_f_gol_selecao" value="na"><label for="m_f_gol_na">Não Explorado</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Impedimentos</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="m_impedimentos_totais" name="m_impedimentos_selecao" value="totais"><label for="m_impedimentos_totais">Under/Over - Totais</label></div>
                        <div class="option-item"><input type="radio" id="m_impedimentos_equipes" name="m_impedimentos_selecao" value="equipes"><label for="m_impedimentos_equipes">Under/Over - Equipes</label></div>
                        <div class="option-item"><input type="radio" id="m_impedimentos_totais_ht" name="m_impedimentos_selecao" value="totais_ht"><label for="m_impedimentos_totais_ht">Under/Over - Totais - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_impedimentos_equipes_ht" name="m_impedimentos_selecao" value="equipes_ht"><label for="m_impedimentos_equipes_ht">Under/Over - Equipes - HT</label></div>
                        <div class="option-item"><input type="radio" id="m_impedimentos_na" name="m_impedimentos_selecao" value="na"><label for="m_impedimentos_na">Não Explorado</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Outros Mercados</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="m_outros_ambos" name="m_outros_selecao" value="ambos_marcam"><label for="m_outros_ambos">Ambos Marcam</label></div>
                        <div class="option-item"><input type="radio" id="m_outros_trave" name="m_outros_selecao" value="bola_trave"><label for="m_outros_trave">Bola na Trave</label></div>
                        <div class="option-item"><input type="radio" id="m_outros_handicap" name="m_outros_selecao" value="handicap"><label for="m_outros_handicap">Handicap</label></div>
                        <div class="option-item"><input type="radio" id="m_outros_ha" name="m_outros_selecao" value="handicap_asiatico"><label for="m_outros_ha">Handicap Asiático</label></div>
                        <div class="option-item"><input type="radio" id="m_outros_penalti" name="m_outros_selecao" value="penalti"><label for="m_outros_penalti">Pênalti</label></div>
                        <div class="option-item"><input type="radio" id="m_outros_jogador" name="m_outros_selecao" value="especiais_jogador"><label for="m_outros_jogador">Especiais Jogador</label></div>
                        <div class="option-item"><input type="radio" id="m_outros_na" name="m_outros_selecao" value="na"><label for="m_outros_na">Não Explorado</label></div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="mercados_obs">Outros/OBS (Mercados)</label>
                    <textarea id="mercados_obs" name="mercados_obs" rows="4" placeholder="Descreva outros mercados explorados ou adicione observações..."></textarea>
                </div>
            </fieldset>

            <fieldset class="main-fieldset">
                <legend class="fieldset-legend-main">Implementação da Operação</legend>
                <div class="sub-group">
                    <p class="question-title">Estratégia Implementada</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="op_impl_sim" name="op_estrategia_implementada" value="sim" required><label for="op_impl_sim">Sim</label></div>
                        <div class="option-item"><input type="radio" id="op_impl_nao_liq" name="op_estrategia_implementada" value="nao_liquidez"><label for="op_impl_nao_liq">Não - Liquidez</label></div>
                        <div class="option-item"><input type="radio" id="op_impl_nao_op" name="op_estrategia_implementada" value="nao_operacional"><label for="op_impl_nao_op">Não - Operacional</label></div>
                        <div class="option-item"><input type="radio" id="op_impl_nao_tempo" name="op_estrategia_implementada" value="nao_tempo"><label for="op_impl_nao_tempo">Não - Tempo</label></div>
                    </div>
                </div>
                <div class="sub-group">
                    <p class="question-title">Problemas</p>
                    <div class="options-container">
                        <div class="option-item"><input type="radio" id="op_prob_nenhum" name="op_problemas" value="nenhum"><label for="op_prob_nenhum">Nenhum</label></div>
                        <div class="option-item"><input type="radio" id="op_prob_mercado" name="op_problemas" value="falta_mercado"><label for="op_prob_mercado">Falta de Mercado</label></div>
                        <div class="option-item"><input type="radio" id="op_prob_liquidez" name="op_problemas" value="falta_liquidez"><label for="op_prob_liquidez">Falta de Liquidez Faixa Pretendida</label></div>
                        <div class="option-item"><input type="radio" id="op_prob_multipla" name="op_problemas" value="dificuldade_multipla"><label for="op_prob_multipla">Dificuldades com Múltipla</label></div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="op_obs_implementacao">Outros / OBS (Implementação)</label>
                    <textarea id="op_obs_implementacao" name="op_obs_implementacao" rows="4" placeholder="Descreva outros problemas ou adicione observações..."></textarea>
                </div>
            </fieldset>

            <div class="form-group">
                <label for="file_upload">Upload - Relatório da Análise e/ou Outros</label>
                <input type="file" id="file_upload" name="relatorios[]" multiple>
            </div>

            <button type="submit" class="submit-button">Finalizar e Enviar Registro</button>
        </form>
    </div>

    <script>
        function populateSelect(selectId, optionsArray) {
            const selectElement = document.getElementById(selectId);
            if (!selectElement) return;

            const otherOption = selectElement.querySelector('option[value^="outro_"]');
            const placeholderOption = selectElement.options[0]; 

            while (selectElement.options.length > 0) {
                if (selectElement.options[0] === placeholderOption || selectElement.options[0] === otherOption) {
                    break; 
                }
                if (selectElement.options.length > 1 && selectElement.options[1] !== otherOption) {
                     selectElement.remove(1);
                } else if (selectElement.options.length === 1 && selectElement.options[0] !== placeholderOption) {
                     selectElement.remove(0); 
                } else {
                     if(selectElement.options.length === 1 && selectElement.options[0] !== placeholderOption && selectElement.options[0] !== otherOption) {
                        selectElement.remove(0);
                     } else if (selectElement.options.length > 1) {
                        for (let i = selectElement.options.length - 1; i >= 0; i--) {
                            const currentOption = selectElement.options[i];
                            if (currentOption !== placeholderOption && currentOption !== otherOption) {
                                selectElement.remove(i);
                            }
                        }
                     }
                     break;
                }
            }
            
            let sortedOptions = Array.isArray(optionsArray) ? [...optionsArray] : [];
            sortedOptions.sort((a, b) => String(a).localeCompare(String(b)));
            
            sortedOptions.forEach(optionText => {
                if (optionText === null || optionText === undefined || String(optionText).trim() === "") return;
                
                let optionExists = false;
                for(let i=0; i < selectElement.options.length; i++) {
                    if(selectElement.options[i].value === optionText) {
                        optionExists = true;
                        break;
                    }
                }
                if(optionExists) return;

                const option = document.createElement('option');
                option.value = optionText;
                option.textContent = optionText;
                if (otherOption) {
                    selectElement.insertBefore(option, otherOption);
                } else {
                    selectElement.appendChild(option);
                }
            });
        }

        function setupDynamicSelect(selectId, inputId, optionValueToTrigger, isNumeric, suffix) {
            const selectElement = document.getElementById(selectId);
            const inputElement = document.getElementById(inputId);
            if (!selectElement || !inputElement) { return; }
            selectElement.addEventListener('change', function() {
                if (this.value === optionValueToTrigger) {
                    inputElement.style.display = 'block';
                    inputElement.focus();
                } else {
                    inputElement.style.display = 'none';
                }
            });
            inputElement.addEventListener('keydown', function(event) {
                if (event.keyCode === 13) {
                    event.preventDefault();
                    let newText = inputElement.value.trim();
                    if (newText) {
                        if (isNumeric && isNaN(newText)) {
                            alert("Por favor, insira um valor numérico.");
                            return;
                        }
                        if (suffix) { newText += suffix; }

                        let optionExists = false;
                        for(let i=0; i < selectElement.options.length; i++) {
                            if(selectElement.options[i].value.toLowerCase() === newText.toLowerCase()) {
                                selectElement.value = selectElement.options[i].value;
                                optionExists = true;
                                break;
                            }
                        }

                        if (!optionExists) {
                            const currentOptionTexts = [];
                            for (let i = 0; i < selectElement.options.length; i++) {
                                const opt = selectElement.options[i];
                                if (opt.value && opt.value !== optionValueToTrigger && !opt.disabled) {
                                    currentOptionTexts.push(opt.textContent);
                                }
                            }
                            currentOptionTexts.push(newText);
                            populateSelect(selectId, currentOptionTexts);
                            selectElement.value = newText;
                        }
                        
                        inputElement.value = '';
                        inputElement.style.display = 'none';
                        selectElement.dispatchEvent(new Event('change'));
                    }
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            const scriptUrl = "https://script.google.com/macros/s/AKfycbzMohuS0VcT2_f5f-gU4h-8-ADFknbYvvdlODFNyKIWhSzgYVTYM8drqOhJZodiSQRB/exec";
            
            fetch(scriptUrl)
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        console.error("Erro ao buscar listas:", data.error);
                        return;
                    }
                    if (data.Equipes) {
                        populateSelect('home_team_reordered_select', data.Equipes);
                        populateSelect('away_team_reordered_select', data.Equipes);
                    }
                    if (data.Campeonatos) populateSelect('campeonato_select', data.Campeonatos);
                    if (data.Estrategias) populateSelect('estrategia_select', data.Estrategias);
                    if (data.CasasDeApostas) populateSelect('casa_apostas_select', data.CasasDeApostas);
                    if (data.PerfisDePartida) populateSelect('perfil_partida_select', data.PerfisDePartida);
                    if (data.Stakes) populateSelect('stake_select', data.Stakes);
                    console.log("Listas dinâmicas carregadas e ordenadas com sucesso!");
                })
                .catch(error => console.error('Erro ao buscar listas do Google Sheet:', error));
                
            setupDynamicSelect('home_team_reordered_select', 'outro_home_team_reordered_input', 'outro_home_team_reordered');
            setupDynamicSelect('away_team_reordered_select', 'outro_away_team_reordered_input', 'outro_away_team_reordered');
            setupDynamicSelect('estrategia_select', 'outra_estrategia_input', 'outro_estrategia');
            setupDynamicSelect('casa_apostas_select', 'outra_casa_apostas_input', 'outro_casa_apostas');
            setupDynamicSelect('campeonato_select', 'outro_campeonato_input', 'outro_campeonato');
            setupDynamicSelect('perfil_partida_select', 'outro_perfil_partida_input', 'outro_perfil_partida');
            setupDynamicSelect('stake_select', 'outra_stake_input', 'outro_stake', true, ' Un');
            setupDynamicSelect('esporte_select', 'outro_esporte_input', 'outro_esporte');
            
            const form = document.getElementById('analiseOperacaoForm');
            const mercadosExploradosFieldset = document.getElementById('mercados_explorados_fieldset');

            if (form && mercadosExploradosFieldset) {
                form.addEventListener('submit', function(event) {
                    const checkedRadiosInMercados = mercadosExploradosFieldset.querySelectorAll('input[type="radio"]:checked');
                    if (checkedRadiosInMercados.length === 0) {
                        alert("Por favor, selecione ao menos uma opção em 'Mercados Explorados'.");
                        event.preventDefault(); 
                        mercadosExploradosFieldset.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        return false;
                    }
                });
            }
        });
    </script>

</body>
</html>
